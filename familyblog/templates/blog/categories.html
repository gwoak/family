{% extends 'base.html' %}

{% block content %}

{% if user.is_authenticated %}

{% if category_posts %}
<div class="container">   
    <a href="{% url 'blog_home' %}" class="btn btn-outline-secondary">Back</a>
    
    <h1 class="text-center mt-3">{{ cats }}</h1>
    <p></p>
    {% for post in category_posts %}
    <div class="row no-gutters border rounded overflow-hidden flex-md-row mb-4 shadow-sm position-relative">
        <ul class="list-group list-group-flush">
          <li class="list-group-item">              
                    <a href="{% url 'post_detail' post.pk %}"><h4>{{ post.title }}</h4></a>            
                        &nbsp;&nbsp;&nbsp; By:&nbsp;<a href="{% url 'author' post.author_id %}">{{ post.author.first_name }}</a>
                        - {{ post.date_created|date:'F d, Y' }} in category: <a>{{ post.category }}</a>
                        <small>
                            {% if user.id == post.author.id %}
                                <a href="{% url 'update_post' post.pk %}" class="btn btn-outline-secondary btn-sm">Edit</a>
                                <a href="{% url 'delete_post' post.pk %}" class="btn btn-outline-danger btn-sm">Delete</a>
                            {% endif %}
                        </small>
                    <p></p>
                    {{ post.snippet|safe }}...<a href="{% url 'post_detail' post.pk %}"><small>Read more</small></a>
                        
                </li>
            </ul>
                
        </div>
                    
        
        {% endfor %}
        <div>
            <nav aria-label="Page navigation">
                <ul class="pagination">            
                    {% if category_posts.has_previous %}
                    <li class="page-item"><a class="page-link" href="?page=1">&laquo; First</a></li>
                        <li class="page-item"><a class="page-link" href="?page={{ category_posts.previous_page_number }}">Previous</a></li>
                    {% endif %} 
                        <li class="page-item disabled"><a href="#" class="page-link">Page {{ category_posts.number }} of {{ category_posts.paginator.num_pages }}</a></li>          
                    {% if category_posts.has_next %}
                        <li class="page-item"><a class="page-link" href="?page={{ category_posts.next_page_number }}">Next</a></li>
                        <li class="page-item"><a class="page-link" href="?page={{ category_posts.paginator.num_pages }}">Last &raquo;</a></li>
                    {% endif %}
                </ul>
            </nav>
        </div>
</div>
        {% else %}
        <div class="container">
         <h2>Sorry, this category has no posts or does not exist...</h2>
        </div>
         {% endif %}
{% else %}
   
        You're not authorised to be here! (And you know it...)
  
{% endif %}

{% endblock %}